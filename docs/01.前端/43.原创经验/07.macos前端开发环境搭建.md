
# macOS 前端开发环境搭建
此篇文章适合初入macOS的同学，主要涉及一些基础性的环境搭建
<!-- more -->

## 写在前面
- 确保网络通畅
- 熟悉macOS快捷键及切换
- [macwk](https://macwk.com/)
- 必要的软件支持，例如 FastZip，解压缩

## 禁用检验
对于开发者来说，比较简单的办法就是关闭信任检验，禁用Gatekeeper，执行如下命令：

```$ sudo spctl --master-disable```

## 开发环境

### vscode下载&安装
- [vscode加速下载](https://az764295.vo.msecnd.net/stable/899d46d82c4c95423fb7e10e68eba52050e30ba3/VSCode-darwin-universal.zip)

```
# 国内加速下载方案替换：
# 原链接：
https://vscode.cdn.azure.cn/stable/899d46d82c4c95423fb7e10e68eba52050e30ba3/VSCode-darwin-universal.zip
# 替换：
vscode.cdn.azure.cn =》az764295.vo.msecnd.net
# 替换后：
https://az764295.vo.msecnd.net/stable/899d46d82c4c95423fb7e10e68eba52050e30ba3/VSCode-darwin-universal.zip
```

### 安装HomeBrew
HomeBrew类似Linux下的 apt-get的包管理工具

[mac下镜像飞速安装Homebrew教程](https://zhuanlan.zhihu.com/p/90508170)

#### 国内安装遇到问题
由于国内访问github受限，所以如果按照[HomeBrew官方](https://brew.sh)安装，会遇到类似如下问题：
```
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
.....
curl: (7) Failed to connect to raw.githubusercontent.com port 443: Operation timed out
```

#### [解决方法](https://brew.idayer.com)：
```
/bin/bash -c "$(curl -fsSL https://cdn.jsdelivr.net/gh/ineo6/homebrew-install/install.sh)"
```
最后看到 ==> Installation successful! 就说明安装成功了

最后更新下：
```
brew update
```
#### 设置镜像

brew、homebrew/core是必备项目，homebrew/cask、homebrew/bottles按需设置。

通过 brew config 命令可以查看相关配置信息。

```
# 中科大源
git -C "$(brew --repo)" remote set-url origin https://mirrors.ustc.edu.cn/brew.git

git -C "$(brew --repo homebrew/core)" remote set-url origin https://mirrors.ustc.edu.cn/homebrew-core.git

git -C "$(brew --repo homebrew/cask)" remote set-url origin https://mirrors.ustc.edu.cn/homebrew-cask.git

brew update
```
配置cask源可能会报错，暂时跳过

#### 设置bottles镜像

设置环境变量需要注意终端Shell的类型，请看下面说明：

镜像以中科大源为例。

从macOS Catalina(10.15.x) 版开始，Mac使用zsh作为默认Shell，对应文件是.zprofile，所以命令为：

```
echo 'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles/bottles' >> ~/.zprofile
source ~/.zprofile
```

如果是macOS Mojave 及更低版本，并且没有自己配置过zsh，对应文件则是.bash_profile：

```
echo 'export HOMEBREW_BOTTLE_DOMAIN=https://mirrors.ustc.edu.cn/homebrew-bottles/bottles' >> ~/.bash_profile
source ~/.bash_profile
```

注意：上述区别仅仅是.zprofile和.bash_profile不同，文章如有再次提及编辑.zprofile，均按此方法替换

#### 恢复默认源

```
git -C "$(brew --repo)" remote set-url origin https://github.com/Homebrew/brew.git

git -C "$(brew --repo homebrew/core)" remote set-url origin https://github.com/Homebrew/homebrew-core.git

git -C "$(brew --repo homebrew/cask)" remote set-url origin https://github.com/Homebrew/homebrew-cask.git

brew update
```
homebrew-bottles配置只能手动删除，将 ~/.zprofile 文件中的 HOMEBREW_BOTTLE_DOMAIN=https://mirrors.xxx.com内容删除，并执行 source ~/.zprofile

#### 卸载Homebrew
```
/bin/bash -c "$(curl -fsSL https://cdn.jsdelivr.net/gh/ineo6/homebrew-install/uninstall.sh)"
```

#### 参考链接
[中科大源](http://mirrors.ustc.edu.cn/help/index.html)

[清华大学源](https://mirror.tuna.tsinghua.edu.cn/help/homebrew/)

### nvm&node安装
nvm作为node版本管理工具，近年来已被广泛运用，但同样也是由于访问github受限，采用离线安装方式

- [nvm下载](https://github.com/nvm-sh/nvm/releases)

- nvm安装，解压缩nvm-master.zip包

```
# 调整相应脚本执行权限
chmod +x install.sh

# 执行安装
./install.sh 

# 执行后，根据提示修改脚本
touch ~/.bash_profile

# 编辑 bash_profile 
vim ~/.bash_profile

# 复制以下内容，粘贴到 bash_profile
export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"  # This loads nvm
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"  # This loads nvm bash_completion

# 最后：ESC, 冒号，wq

# 刷新 bash_profile
source ~/.bash_profile

# 测试nvm是否安装成功
nvm --version

# 查看node可用版本
nvm ls-remote

# 安装对应node版本
nvm install v16.13.1

# 使用node
nvm use v16.13.1
```

### nrm安装
nrm是管理node镜像源的工具

```
# 查看镜像源列表
nrm ls

# 添加内网镜像源地址
nrm add cmschina http://artifacts.cmschina.com.cn/artifactory/api/npm/public-npm-rdm-remote/

# 使用镜像源
nrm use cmschina
```

### git 安装
需要预先安装好**HomeBrew**
```
brew install git
```
[配置多个ssh公钥](https://zhuanlan.zhihu.com/p/154604608)

### chrome 插件安装
需要科学上网，这里推荐 SetupVPN ，通过它可以访问到 Chorme应用市场

### xcode
通过AppStore安装 xcode,需要有 AppleID,登录后即可下载安装
